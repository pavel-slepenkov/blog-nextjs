<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><link href="https://unpkg.com/prismjs@1.23.0/themes/prism-okaidia.css" rel="stylesheet"/><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Pavel Slepenkov&#x27;s personal blog: stories about BI, python, salesforce and data analysis"/><meta http-equiv="cache-control" content="Private"/><meta http-equiv="Expires" content="366000"/><meta property="og:locale" content="en_US"/><meta name="og:title" content="Pavel Slepenkov&#x27;s personal blog"/><meta property="og:description" content="stories about BI, python, salesforce and data analysis"/><meta property="og:type" content="article"/><meta property="og:site_name" content="pavelslepenkov.info"/><meta property="og:image" content="/og.png"/><meta name="twitter:title" content="Pavel Slepenkov&#x27;s personal blog"/><meta name="twitter:description" content="stories about BI, python, salesforce and data analysis"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="/og.png"/><meta name="keywords" content="python, BI, sql, salesforce, data engineering, apex, soql, data analisys"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-63037633-1"></script><script>
                            window.dataLayer = window.dataLayer || [];
                            function gtag(){dataLayer.push(arguments);}
                            gtag('js', new Date());
                            gtag('config', 'UA-63037633-1');
                    </script><style>@import url(&#x27;https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300&amp;family=Spectral:wght@300;600&amp;display=swap&#x27;);</style><title>Using pyenv with Orange Pi</title><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/e1ade21c945e1e76c25a.css" as="style"/><link rel="stylesheet" href="/_next/static/css/e1ade21c945e1e76c25a.css" data-n-g=""/><link rel="preload" href="/_next/static/css/6dce80f39b6e217927f5.css" as="style"/><link rel="stylesheet" href="/_next/static/css/6dce80f39b6e217927f5.css" data-n-p=""/><noscript data-n-css=""></noscript><link rel="preload" href="/_next/static/chunks/main-d99e70035f31fbf26280.js" as="script"/><link rel="preload" href="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" as="script"/><link rel="preload" href="/_next/static/chunks/framework.ef157c678a62cfb2c073.js" as="script"/><link rel="preload" href="/_next/static/chunks/commons.0cd3f0b406132b99fef1.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/_app-f576db2e6f64d3b421e3.js" as="script"/><link rel="preload" href="/_next/static/chunks/b435696c38dfa3a566dd7089f731d08d7e0bf097.59063565129a361a1f22.js" as="script"/><link rel="preload" href="/_next/static/chunks/1d62a1056678c2f23610de94ff6f49e06a569636.b588272bed0c9114d503.js" as="script"/><link rel="preload" href="/_next/static/chunks/pages/posts/%5Bid%5D-dd3e2b826f95ad4c71da.js" as="script"/></head><body class="centered"><script src="noflash.js"></script><script src="PathSolver.js"></script><div id="__next"><div class="layout_container__2t4v2"><div class="no-print"><header class="layout_header__2rhWq"><div class="navbar-link"><a class="layout_devNull__6Fs9d" href="/">$ /dev/null</a>—————<a class="layout_devNull__6Fs9d" href="/cv">CV</a></div><div class="DarkModeToggle_darkModeToggle__2u4u3"><button type="button">☀</button><toggle></toggle><button type="button">☾</button></div></header></div><main><article><h1 class="utils_headingXl__1XecN">Using pyenv with Orange Pi</h1><div class="utils_lightText__12Ckm"><time dateTime="2021-12-03T21:25:00+00:00">December 3, 2021</time></div><div><p><strong>Orange Pi Zero 2</strong> is a great product which I use a lot for a side projects. It's pretty cheap, has a tiny size and also easy to setup and run. Those it's good alternative to cloud environments if you need some not very beefy server to run your experiments. I'm running a few web crawlers on Orange PI and very happy with that.</p>
<p>I use Armbian Debian as an OS for orange pi. It's pretty straightforward how to setup it:</p>
<ul>
<li><a href="https://www.armbian.com/download/">download the image compatible with your device</a></li>
<li><a href="https://www.balena.io/etcher/">flash it to reliable microSD card with Etcher</a></li>
<li>Insert the microSD card into the memory slot of the Orange Pi Zero, connect an Ethernet cable and plug in a micro USB cable to power the board.</li>
<li>Find new host on your local network and connect via ssh <strong>ssh root@192.168.1.144</strong> with default password 1234</li>
</ul>
<p>That simple</p>
<p>By default <strong>python 3.7.3</strong> is installed on Armbian (on 2021-12-03). But my codebase uses a different versions of python, and if I'd not to mess up all the environment at the start I need to setup some python version management which allows to switch python versions based on project's need. I preffer to use <ps1>pyenv</ps1>.</p>
<p>It's not to hard to install it, all the needed instructions are in <a href="https://github.com/pyenv/pyenv">its repo</a></p>
<p>First you need to install build dependencies</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update<span class="token punctuation">;</span> <span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> <span class="token function">make</span> build-essential libssl-dev zlib1g-dev <span class="token punctuation">\</span>
libbz2-dev libreadline-dev libsqlite3-dev <span class="token function">wget</span> <span class="token function">curl</span> llvm <span class="token punctuation">\</span>
libncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev
</code></pre></div>
<p>Then run installation via the following command, which I find very convenient (although you could clone repo and build it yourself)</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">curl</span> https://pyenv.run <span class="token operator">|</span> <span class="token function">bash</span>
</code></pre></div>
<p>Then you need to run a set of commands to setup your environment variables</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token function">sed</span> -Ei -e <span class="token string">'/^([^#]|$)/ {a \
export PYENV_ROOT="<span class="token environment constant">$HOME</span>/.pyenv"
a \
export PATH="<span class="token variable">$PYENV_ROOT</span>/bin:<span class="token environment constant">$PATH</span>"
a \
'</span> -e <span class="token string">':a'</span> -e <span class="token string">'<span class="token variable">$!</span>{n;ba};}'</span> ~/.profile
</code></pre></div>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">echo</span> <span class="token string">'eval "<span class="token variable"><span class="token variable">$(</span>pyenv init --path<span class="token variable">)</span></span>"'</span> <span class="token operator">>></span>~/.profile
<span class="token builtin class-name">echo</span> <span class="token string">'eval "<span class="token variable"><span class="token variable">$(</span>pyenv init -<span class="token variable">)</span></span>"'</span> <span class="token operator">>></span> ~/.bashrc
</code></pre></div>
<p>Now you have <strong>pyenv</strong> installed and ready to use.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">pyenv <span class="token function">install</span> <span class="token number">3.10</span>.0
</code></pre></div>
<p>I tried it and got the following result (<em>which you probably got too if reading it</em>)</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">pyenv <span class="token function">install</span> <span class="token number">3.10</span>.0
Downloading Python-3.10.0.tar.xz<span class="token punctuation">..</span>.
-<span class="token operator">></span> https://www.python.org/ftp/python/3.10.0/Python-3.10.0.tar.xz
Installing Python-3.10.0<span class="token punctuation">..</span>.
patching <span class="token function">file</span> aclocal.m4
patching <span class="token function">file</span> configure
Hunk <span class="token comment">#5 succeeded at 10537 (offset -15 lines).</span>

BUILD FAILED <span class="token punctuation">(</span>Debian <span class="token number">10</span> using python-build <span class="token number">20180424</span><span class="token punctuation">)</span>

Inspect or clean up the working tree at /tmp/python-build.20211216110110.13432
Results logged to /tmp/python-build.20211216110110.13432.log

Last <span class="token number">10</span> log lines:
      -o Modules/getbuildinfo.o ./Modules/getbuildinfo.c
<span class="token function">rm</span> -f libpython3.10.a
ar rcs libpython3.10.a Modules/getbuildinfo.o Parser/token.o  Parser/pegen.o Parser/parser.o Parser/string_parser.o Parser/peg_api.o Parser/myreadline.o Parser/tokenizer.o Objects/abstract.o Objects/accu.o Objects/boolobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/bytesobject.o Objects/call.o Objects/capsule.o Objects/cellobject.o Objects/classobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genericaliasobject.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/interpreteridobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/odictobject.o Objects/memoryobject.o Objects/methodobject.o Objects/moduleobject.o Objects/namespaceobject.o Objects/object.o Objects/obmalloc.o Objects/picklebufobject.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/unicodeobject.o Objects/unicodectype.o Objects/unionobject.o Objects/weakrefobject.o Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/ast_opt.o Python/ast_unparse.o Python/bltinmodule.o Python/ceval.o Python/codecs.o Python/compile.o Python/context.o Python/dynamic_annotations.o Python/errors.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getplatform.o Python/getversion.o Python/hamt.o Python/hashtable.o Python/import.o Python/importdl.o Python/initconfig.o Python/marshal.o Python/modsupport.o Python/mysnprintf.o Python/mystrtoul.o Python/pathconfig.o Python/preconfig.o Python/pyarena.o Python/pyctype.o Python/pyfpe.o Python/pyhash.o Python/pylifecycle.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/pytime.o Python/bootstrap_hash.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/thread.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/pystrhex.o Python/dtoa.o Python/formatter_unicode.o Python/fileutils.o Python/suggestions.o Python/dynload_shlib.o    Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/_weakref.o  Modules/_functoolsmodule.o  Modules/_operator.o  Modules/_collectionsmodule.o  Modules/_abc.o  Modules/itertoolsmodule.o  Modules/atexitmodule.o  Modules/signalmodule.o  Modules/_stat.o  Modules/timemodule.o  Modules/_threadmodule.o  Modules/_localemodule.o  Modules/_iomodule.o Modules/iobase.o Modules/fileio.o Modules/bytesio.o Modules/bufferedio.o Modules/textio.o Modules/stringio.o  Modules/faulthandler.o  Modules/_tracemalloc.o  Modules/symtablemodule.o  Modules/xxsubtype.o Python/frozen.o
gcc -pthread -L/home/pavel/.pyenv/versions/3.10.0/lib  -L/home/pavel/.pyenv/versions/3.10.0/lib    -Xlinker -export-dynamic -o python Programs/python.o libpython3.10.a -lcrypt -lpthread -ldl  -lutil -lm   -lm 
gcc -pthread -L/home/pavel/.pyenv/versions/3.10.0/lib  -L/home/pavel/.pyenv/versions/3.10.0/lib    -Xlinker -export-dynamic -o Programs/_testembed Programs/_testembed.o libpython3.10.a -lcrypt -lpthread -ldl  -lutil -lm   -lm 
collect2: error: ld returned <span class="token number">1</span> <span class="token builtin class-name">exit</span> status
make: *** <span class="token punctuation">[</span>Makefile:737: Programs/_testembed<span class="token punctuation">]</span> Error <span class="token number">1</span>
make: *** Waiting <span class="token keyword">for</span> unfinished jobs<span class="token punctuation">..</span><span class="token punctuation">..</span>
collect2: error: ld returned <span class="token number">1</span> <span class="token builtin class-name">exit</span> status
make: *** <span class="token punctuation">[</span>Makefile:602: python<span class="token punctuation">]</span> Error <span class="token number">1</span>
</code></pre></div>
<p>You can check the logs and though the reading it you will notice something like <strong>/tmp no space left on device</strong> what's pretty weird as there's a lot of space on newly spinned server.</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">pavel@orangepizero2:~$ <span class="token function">df</span> -h

Filesystem      Size  Used Avail Use% Mounted on
udev            470M     <span class="token number">0</span>  470M   <span class="token number">0</span>% /dev
tmpfs            97M  <span class="token number">5</span>.4M   92M   <span class="token number">6</span>% /run
/dev/mmcblk0p1   29G  <span class="token number">1</span>.8G   27G   <span class="token number">7</span>% /
tmpfs           483M     <span class="token number">0</span>  483M   <span class="token number">0</span>% /dev/shm
tmpfs           <span class="token number">5</span>.0M  <span class="token number">4</span>.0K  <span class="token number">5</span>.0M   <span class="token number">1</span>% /run/lock
tmpfs           483M     <span class="token number">0</span>  483M   <span class="token number">0</span>% /sys/fs/cgroup
/dev/zram1      468M  752K  433M   <span class="token number">1</span>% /tmp
armbian-ramlog   50M  <span class="token number">4</span>.7M   46M  <span class="token number">10</span>% /var/log
tmpfs            97M     <span class="token number">0</span>   97M   <span class="token number">0</span>% /run/user/1000
</code></pre></div>
<p>You might notice that <strong>/tmp</strong> <code>/dev/zram1      468M  752K  433M   1% /tmp</code> isn't a big enough , but <strong>pyenv</strong> is used it to unpack and operate during installation. So you need to fix it somehow. There's a few solutions, including increasing /tmp size, but the simplest one is to add <code>TMPDIR</code> environment variable which allows <strong>pyenv</strong> to use all the disk space on device where you pointed it. Run in terminal or add it to <strong>.bashrc</strong> if you want to make it permanent (as pip will also use TMPDIR).</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash"><span class="token builtin class-name">export</span> <span class="token assign-left variable">TMPDDIR</span><span class="token operator">=</span>/var/tmp
</code></pre></div>
<p>This will fix the problem and a next pyenv run will be completed succefully.</p>
<p><strong>PS</strong> / You might get the following error</p>
<div class="remark-highlight"><pre class="language-bash"><code class="language-bash">pyenv <span class="token function">install</span> -v <span class="token number">3.10</span>.0
python-build: <span class="token assign-left variable">TMPDIR</span><span class="token operator">=</span>/var/tmp is <span class="token builtin class-name">set</span> to a non-accessible location
</code></pre></div>
<p>That's the result of running <strong>systemctl mask tmp.mount</strong> which is another option to fix /tmp space issue. To fix it you need to remount <code>sudo mount -o remount,rw /</code></p>
</div></article><div><span class="utils_tag__38-Vr"><a href="/tag/python">[<!-- -->python<!-- -->]</a></span><span class="utils_tag__38-Vr"><a href="/tag/pyenv">[<!-- -->pyenv<!-- -->]</a></span><span class="utils_tag__38-Vr"><a href="/tag/orangepi">[<!-- -->orangepi<!-- -->]</a></span></div></main><div class="layout_backToHome__1vZsp"><a href="/">⇐ back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"using-pyenv-with-orangepi","contentHtml":"\u003cp\u003e\u003cstrong\u003eOrange Pi Zero 2\u003c/strong\u003e is a great product which I use a lot for a side projects. It's pretty cheap, has a tiny size and also easy to setup and run. Those it's good alternative to cloud environments if you need some not very beefy server to run your experiments. I'm running a few web crawlers on Orange PI and very happy with that.\u003c/p\u003e\n\u003cp\u003eI use Armbian Debian as an OS for orange pi. It's pretty straightforward how to setup it:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003e\u003ca href=\"https://www.armbian.com/download/\"\u003edownload the image compatible with your device\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003e\u003ca href=\"https://www.balena.io/etcher/\"\u003eflash it to reliable microSD card with Etcher\u003c/a\u003e\u003c/li\u003e\n\u003cli\u003eInsert the microSD card into the memory slot of the Orange Pi Zero, connect an Ethernet cable and plug in a micro USB cable to power the board.\u003c/li\u003e\n\u003cli\u003eFind new host on your local network and connect via ssh \u003cstrong\u003essh root@192.168.1.144\u003c/strong\u003e with default password 1234\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eThat simple\u003c/p\u003e\n\u003cp\u003eBy default \u003cstrong\u003epython 3.7.3\u003c/strong\u003e is installed on Armbian (on 2021-12-03). But my codebase uses a different versions of python, and if I'd not to mess up all the environment at the start I need to setup some python version management which allows to switch python versions based on project's need. I preffer to use \u003cps1\u003epyenv\u003c/ps1\u003e.\u003c/p\u003e\n\u003cp\u003eIt's not to hard to install it, all the needed instructions are in \u003ca href=\"https://github.com/pyenv/pyenv\"\u003eits repo\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eFirst you need to install build dependencies\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003esudo\u003c/span\u003e \u003cspan class=\"token function\"\u003eapt-get\u003c/span\u003e update\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e \u003cspan class=\"token function\"\u003esudo\u003c/span\u003e \u003cspan class=\"token function\"\u003eapt-get\u003c/span\u003e \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e \u003cspan class=\"token function\"\u003emake\u003c/span\u003e build-essential libssl-dev zlib1g-dev \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\nlibbz2-dev libreadline-dev libsqlite3-dev \u003cspan class=\"token function\"\u003ewget\u003c/span\u003e \u003cspan class=\"token function\"\u003ecurl\u003c/span\u003e llvm \u003cspan class=\"token punctuation\"\u003e\\\u003c/span\u003e\nlibncursesw5-dev xz-utils tk-dev libxml2-dev libxmlsec1-dev libffi-dev liblzma-dev\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen run installation via the following command, which I find very convenient (although you could clone repo and build it yourself)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003ecurl\u003c/span\u003e https://pyenv.run \u003cspan class=\"token operator\"\u003e|\u003c/span\u003e \u003cspan class=\"token function\"\u003ebash\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen you need to run a set of commands to setup your environment variables\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token function\"\u003esed\u003c/span\u003e -Ei -e \u003cspan class=\"token string\"\u003e'/^([^#]|$)/ {a \\\nexport PYENV_ROOT=\"\u003cspan class=\"token environment constant\"\u003e$HOME\u003c/span\u003e/.pyenv\"\na \\\nexport PATH=\"\u003cspan class=\"token variable\"\u003e$PYENV_ROOT\u003c/span\u003e/bin:\u003cspan class=\"token environment constant\"\u003e$PATH\u003c/span\u003e\"\na \\\n'\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e':a'\u003c/span\u003e -e \u003cspan class=\"token string\"\u003e'\u003cspan class=\"token variable\"\u003e$!\u003c/span\u003e{n;ba};}'\u003c/span\u003e ~/.profile\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token builtin class-name\"\u003eecho\u003c/span\u003e \u003cspan class=\"token string\"\u003e'eval \"\u003cspan class=\"token variable\"\u003e\u003cspan class=\"token variable\"\u003e$(\u003c/span\u003epyenv init --path\u003cspan class=\"token variable\"\u003e)\u003c/span\u003e\u003c/span\u003e\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003e\u003c/span\u003e~/.profile\n\u003cspan class=\"token builtin class-name\"\u003eecho\u003c/span\u003e \u003cspan class=\"token string\"\u003e'eval \"\u003cspan class=\"token variable\"\u003e\u003cspan class=\"token variable\"\u003e$(\u003c/span\u003epyenv init -\u003cspan class=\"token variable\"\u003e)\u003c/span\u003e\u003c/span\u003e\"'\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003e\u003c/span\u003e ~/.bashrc\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNow you have \u003cstrong\u003epyenv\u003c/strong\u003e installed and ready to use.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003epyenv \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e \u003cspan class=\"token number\"\u003e3.10\u003c/span\u003e.0\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eI tried it and got the following result (\u003cem\u003ewhich you probably got too if reading it\u003c/em\u003e)\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003epyenv \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e \u003cspan class=\"token number\"\u003e3.10\u003c/span\u003e.0\nDownloading Python-3.10.0.tar.xz\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\n-\u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e https://www.python.org/ftp/python/3.10.0/Python-3.10.0.tar.xz\nInstalling Python-3.10.0\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e.\npatching \u003cspan class=\"token function\"\u003efile\u003c/span\u003e aclocal.m4\npatching \u003cspan class=\"token function\"\u003efile\u003c/span\u003e configure\nHunk \u003cspan class=\"token comment\"\u003e#5 succeeded at 10537 (offset -15 lines).\u003c/span\u003e\n\nBUILD FAILED \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003eDebian \u003cspan class=\"token number\"\u003e10\u003c/span\u003e using python-build \u003cspan class=\"token number\"\u003e20180424\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\nInspect or clean up the working tree at /tmp/python-build.20211216110110.13432\nResults logged to /tmp/python-build.20211216110110.13432.log\n\nLast \u003cspan class=\"token number\"\u003e10\u003c/span\u003e log lines:\n      -o Modules/getbuildinfo.o ./Modules/getbuildinfo.c\n\u003cspan class=\"token function\"\u003erm\u003c/span\u003e -f libpython3.10.a\nar rcs libpython3.10.a Modules/getbuildinfo.o Parser/token.o  Parser/pegen.o Parser/parser.o Parser/string_parser.o Parser/peg_api.o Parser/myreadline.o Parser/tokenizer.o Objects/abstract.o Objects/accu.o Objects/boolobject.o Objects/bytes_methods.o Objects/bytearrayobject.o Objects/bytesobject.o Objects/call.o Objects/capsule.o Objects/cellobject.o Objects/classobject.o Objects/codeobject.o Objects/complexobject.o Objects/descrobject.o Objects/enumobject.o Objects/exceptions.o Objects/genericaliasobject.o Objects/genobject.o Objects/fileobject.o Objects/floatobject.o Objects/frameobject.o Objects/funcobject.o Objects/interpreteridobject.o Objects/iterobject.o Objects/listobject.o Objects/longobject.o Objects/dictobject.o Objects/odictobject.o Objects/memoryobject.o Objects/methodobject.o Objects/moduleobject.o Objects/namespaceobject.o Objects/object.o Objects/obmalloc.o Objects/picklebufobject.o Objects/rangeobject.o Objects/setobject.o Objects/sliceobject.o Objects/structseq.o Objects/tupleobject.o Objects/typeobject.o Objects/unicodeobject.o Objects/unicodectype.o Objects/unionobject.o Objects/weakrefobject.o Python/_warnings.o Python/Python-ast.o Python/asdl.o Python/ast.o Python/ast_opt.o Python/ast_unparse.o Python/bltinmodule.o Python/ceval.o Python/codecs.o Python/compile.o Python/context.o Python/dynamic_annotations.o Python/errors.o Python/frozenmain.o Python/future.o Python/getargs.o Python/getcompiler.o Python/getcopyright.o Python/getplatform.o Python/getversion.o Python/hamt.o Python/hashtable.o Python/import.o Python/importdl.o Python/initconfig.o Python/marshal.o Python/modsupport.o Python/mysnprintf.o Python/mystrtoul.o Python/pathconfig.o Python/preconfig.o Python/pyarena.o Python/pyctype.o Python/pyfpe.o Python/pyhash.o Python/pylifecycle.o Python/pymath.o Python/pystate.o Python/pythonrun.o Python/pytime.o Python/bootstrap_hash.o Python/structmember.o Python/symtable.o Python/sysmodule.o Python/thread.o Python/traceback.o Python/getopt.o Python/pystrcmp.o Python/pystrtod.o Python/pystrhex.o Python/dtoa.o Python/formatter_unicode.o Python/fileutils.o Python/suggestions.o Python/dynload_shlib.o    Modules/config.o Modules/getpath.o Modules/main.o Modules/gcmodule.o Modules/posixmodule.o  Modules/errnomodule.o  Modules/pwdmodule.o  Modules/_sre.o  Modules/_codecsmodule.o  Modules/_weakref.o  Modules/_functoolsmodule.o  Modules/_operator.o  Modules/_collectionsmodule.o  Modules/_abc.o  Modules/itertoolsmodule.o  Modules/atexitmodule.o  Modules/signalmodule.o  Modules/_stat.o  Modules/timemodule.o  Modules/_threadmodule.o  Modules/_localemodule.o  Modules/_iomodule.o Modules/iobase.o Modules/fileio.o Modules/bytesio.o Modules/bufferedio.o Modules/textio.o Modules/stringio.o  Modules/faulthandler.o  Modules/_tracemalloc.o  Modules/symtablemodule.o  Modules/xxsubtype.o Python/frozen.o\ngcc -pthread -L/home/pavel/.pyenv/versions/3.10.0/lib  -L/home/pavel/.pyenv/versions/3.10.0/lib    -Xlinker -export-dynamic -o python Programs/python.o libpython3.10.a -lcrypt -lpthread -ldl  -lutil -lm   -lm \ngcc -pthread -L/home/pavel/.pyenv/versions/3.10.0/lib  -L/home/pavel/.pyenv/versions/3.10.0/lib    -Xlinker -export-dynamic -o Programs/_testembed Programs/_testembed.o libpython3.10.a -lcrypt -lpthread -ldl  -lutil -lm   -lm \ncollect2: error: ld returned \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexit\u003c/span\u003e status\nmake: *** \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eMakefile:737: Programs/_testembed\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e Error \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\nmake: *** Waiting \u003cspan class=\"token keyword\"\u003efor\u003c/span\u003e unfinished jobs\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e..\u003c/span\u003e\ncollect2: error: ld returned \u003cspan class=\"token number\"\u003e1\u003c/span\u003e \u003cspan class=\"token builtin class-name\"\u003eexit\u003c/span\u003e status\nmake: *** \u003cspan class=\"token punctuation\"\u003e[\u003c/span\u003eMakefile:602: python\u003cspan class=\"token punctuation\"\u003e]\u003c/span\u003e Error \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou can check the logs and though the reading it you will notice something like \u003cstrong\u003e/tmp no space left on device\u003c/strong\u003e what's pretty weird as there's a lot of space on newly spinned server.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003epavel@orangepizero2:~$ \u003cspan class=\"token function\"\u003edf\u003c/span\u003e -h\n\nFilesystem      Size  Used Avail Use% Mounted on\nudev            470M     \u003cspan class=\"token number\"\u003e0\u003c/span\u003e  470M   \u003cspan class=\"token number\"\u003e0\u003c/span\u003e% /dev\ntmpfs            97M  \u003cspan class=\"token number\"\u003e5\u003c/span\u003e.4M   92M   \u003cspan class=\"token number\"\u003e6\u003c/span\u003e% /run\n/dev/mmcblk0p1   29G  \u003cspan class=\"token number\"\u003e1\u003c/span\u003e.8G   27G   \u003cspan class=\"token number\"\u003e7\u003c/span\u003e% /\ntmpfs           483M     \u003cspan class=\"token number\"\u003e0\u003c/span\u003e  483M   \u003cspan class=\"token number\"\u003e0\u003c/span\u003e% /dev/shm\ntmpfs           \u003cspan class=\"token number\"\u003e5\u003c/span\u003e.0M  \u003cspan class=\"token number\"\u003e4\u003c/span\u003e.0K  \u003cspan class=\"token number\"\u003e5\u003c/span\u003e.0M   \u003cspan class=\"token number\"\u003e1\u003c/span\u003e% /run/lock\ntmpfs           483M     \u003cspan class=\"token number\"\u003e0\u003c/span\u003e  483M   \u003cspan class=\"token number\"\u003e0\u003c/span\u003e% /sys/fs/cgroup\n/dev/zram1      468M  752K  433M   \u003cspan class=\"token number\"\u003e1\u003c/span\u003e% /tmp\narmbian-ramlog   50M  \u003cspan class=\"token number\"\u003e4\u003c/span\u003e.7M   46M  \u003cspan class=\"token number\"\u003e10\u003c/span\u003e% /var/log\ntmpfs            97M     \u003cspan class=\"token number\"\u003e0\u003c/span\u003e   97M   \u003cspan class=\"token number\"\u003e0\u003c/span\u003e% /run/user/1000\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eYou might notice that \u003cstrong\u003e/tmp\u003c/strong\u003e \u003ccode\u003e/dev/zram1      468M  752K  433M   1% /tmp\u003c/code\u003e isn't a big enough , but \u003cstrong\u003epyenv\u003c/strong\u003e is used it to unpack and operate during installation. So you need to fix it somehow. There's a few solutions, including increasing /tmp size, but the simplest one is to add \u003ccode\u003eTMPDIR\u003c/code\u003e environment variable which allows \u003cstrong\u003epyenv\u003c/strong\u003e to use all the disk space on device where you pointed it. Run in terminal or add it to \u003cstrong\u003e.bashrc\u003c/strong\u003e if you want to make it permanent (as pip will also use TMPDIR).\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003e\u003cspan class=\"token builtin class-name\"\u003eexport\u003c/span\u003e \u003cspan class=\"token assign-left variable\"\u003eTMPDDIR\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e/var/tmp\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThis will fix the problem and a next pyenv run will be completed succefully.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003ePS\u003c/strong\u003e / You might get the following error\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-bash\"\u003e\u003ccode class=\"language-bash\"\u003epyenv \u003cspan class=\"token function\"\u003einstall\u003c/span\u003e -v \u003cspan class=\"token number\"\u003e3.10\u003c/span\u003e.0\npython-build: \u003cspan class=\"token assign-left variable\"\u003eTMPDIR\u003c/span\u003e\u003cspan class=\"token operator\"\u003e=\u003c/span\u003e/var/tmp is \u003cspan class=\"token builtin class-name\"\u003eset\u003c/span\u003e to a non-accessible location\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThat's the result of running \u003cstrong\u003esystemctl mask tmp.mount\u003c/strong\u003e which is another option to fix /tmp space issue. To fix it you need to remount \u003ccode\u003esudo mount -o remount,rw /\u003c/code\u003e\u003c/p\u003e\n","title":"Using pyenv with Orange Pi","date":"2021-12-03T21:25:00+00:00","status":"publish","permalink":"/?p=1079","author":"pavel","excerpt":"","type":"post","tag":["python","pyenv","orangepi"]}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"using-pyenv-with-orangepi"},"buildId":"VkNYhjE8WTMcD1eE4KdBT","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/_next/static/chunks/polyfills-83732ebf2ed7f8a1b2c7.js"></script><script src="/_next/static/chunks/main-d99e70035f31fbf26280.js" async=""></script><script src="/_next/static/chunks/webpack-e067438c4cf4ef2ef178.js" async=""></script><script src="/_next/static/chunks/framework.ef157c678a62cfb2c073.js" async=""></script><script src="/_next/static/chunks/commons.0cd3f0b406132b99fef1.js" async=""></script><script src="/_next/static/chunks/pages/_app-f576db2e6f64d3b421e3.js" async=""></script><script src="/_next/static/chunks/b435696c38dfa3a566dd7089f731d08d7e0bf097.59063565129a361a1f22.js" async=""></script><script src="/_next/static/chunks/1d62a1056678c2f23610de94ff6f49e06a569636.b588272bed0c9114d503.js" async=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-dd3e2b826f95ad4c71da.js" async=""></script><script src="/_next/static/VkNYhjE8WTMcD1eE4KdBT/_buildManifest.js" async=""></script><script src="/_next/static/VkNYhjE8WTMcD1eE4KdBT/_ssgManifest.js" async=""></script></body></html>