<!DOCTYPE html><html><head><meta charSet="utf-8"/><link rel="icon" href="/favicon.ico"/><link href="https://unpkg.com/prismjs@1.23.0/themes/prism-okaidia.css" rel="stylesheet"/><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><meta name="description" content="Pavel Slepenkov&#x27;s personal blog: stories about BI, python, salesforce and data analysis"/><meta http-equiv="cache-control" content="Private"/><meta http-equiv="Expires" content="366000"/><meta property="og:locale" content="en_US"/><meta name="og:title" content="Pavel Slepenkov&#x27;s personal blog"/><meta property="og:description" content="stories about BI, python, salesforce and data analysis"/><meta property="og:type" content="article"/><meta property="og:site_name" content="pavelslepenkov.info"/><meta property="og:image" content="/og.png"/><meta name="twitter:title" content="Pavel Slepenkov&#x27;s personal blog"/><meta name="twitter:description" content="stories about BI, python, salesforce and data analysis"/><meta name="twitter:card" content="summary_large_image"/><meta property="twitter:image" content="/og.png"/><meta name="keywords" content="python, BI, sql, salesforce, data engineering, apex, soql, data analisys"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-63037633-1"></script><script>
                            window.dataLayer = window.dataLayer || [];
                            function gtag(){dataLayer.push(arguments);}
                            gtag('js', new Date());
                            gtag('config', 'UA-63037633-1');
                    </script><style>@import url(&#x27;https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300&amp;family=Spectral:wght@300;600&amp;display=swap&#x27;);</style><title>Remove Postgres / Redshift duplicates without unique key</title><meta name="next-head-count" content="23"/><link rel="preload" href="/_next/static/css/8ed85b7126e02c37.css" as="style"/><link rel="stylesheet" href="/_next/static/css/8ed85b7126e02c37.css" data-n-g=""/><link rel="preload" href="/_next/static/css/aded813adb12d848.css" as="style"/><link rel="stylesheet" href="/_next/static/css/aded813adb12d848.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js"></script><script src="/_next/static/chunks/webpack-ee7e63bc15b31913.js" defer=""></script><script src="/_next/static/chunks/framework-ad45764ecfcae9e5.js" defer=""></script><script src="/_next/static/chunks/main-ee0cf4b7f81d7c24.js" defer=""></script><script src="/_next/static/chunks/pages/_app-2398585b21d2d8c8.js" defer=""></script><script src="/_next/static/chunks/105-51803cf0fd5a7825.js" defer=""></script><script src="/_next/static/chunks/358-14c60bb94e9d94b9.js" defer=""></script><script src="/_next/static/chunks/pages/posts/%5Bid%5D-8fa7937364162cc4.js" defer=""></script><script src="/_next/static/yW2av1iPx4W7zVrpw7Efh/_buildManifest.js" defer=""></script><script src="/_next/static/yW2av1iPx4W7zVrpw7Efh/_ssgManifest.js" defer=""></script></head><body class="centered"><script src="noflash.js"></script><script src="PathSolver.js"></script><div id="__next"><div class="layout_container__fbLkO"><div class="no-print"><header class="layout_header__kY0Lt"><div class="navbar-link centered"><a class="layout_devNull__CjwH1" href="/">Technical notes</a>‚Äî‚Äî‚Äî‚Äî‚Äî<a class="layout_devNull__CjwH1" href="/cv">CV</a>‚Äî‚Äî‚Äî‚Äî‚Äî<a class="layout_devNull__CjwH1" href="/books">Books &amp; Readings</a></div><div class="DarkModeToggle_darkModeToggle__m5z3H"><button type="button">üåû</button><button type="button">üåö</button></div></header></div><main><article><h1 class="utils_headingXl__u25Y2">Remove Postgres / Redshift duplicates without unique key</h1><div class="utils_lightText__eUzGY"><time dateTime="2021-03-03T07:37:23+01:00">March 3, 2021</time></div><div><p>Sometimes you got duplicates in database and have to deal with it. There's 2 possibilities - you have an auto-generated unique id on the table or not. The first case is very easy</p>
<p>Let say we have table feedback where we collect all the feedbacks given by our users. This table has field <code>feedback_id</code> which represents unique id of external system from which data was posted.</p>
<table>
    <thead>
        <tr>
            <th>id</th>
            <th>feedback_id</th>
            <th>type</th>
            <th>date</th>
        </tr>
    </thead>
    <tbody >
        <tr>
            <td>0001</td>
            <td>MX-001</td>
            <td>livechat</td>
            <td>2020-01-01</td>
        </tr>
        <tr>
            <td>0002</td>
            <td>MX-001</td>
            <td>livechat</td>
            <td>2020-01-01</td>
        </tr>
        <tr>
            <td>0003</td>
            <td>MX-001</td>
            <td>livechat</td>
            <td>2020-01-01</td>
        </tr>
        <tr>
            <td>0004</td>
            <td>MX-002</td>
            <td>pendo</td>
            <td>2020-01-03</td>
        </tr>
        <tr>
            <td>0005</td>
            <td>MX-002</td>
            <td>pendo</td>
            <td>2020-01-03</td>
        </tr>
    </tbody>
</table>
<p>If we created an auto-generated Id on it then we safe</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> feedback
<span class="token keyword">where</span> id <span class="token operator">in</span> <span class="token punctuation">(</span>
    <span class="token keyword">with</span> dups <span class="token keyword">as</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> id<span class="token punctuation">,</span>
            row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> feedback_id <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">date</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> rn
        <span class="token keyword">from</span> feedback
    <span class="token punctuation">)</span>
    <span class="token keyword">select</span> id <span class="token keyword">from</span> dups <span class="token keyword">where</span> rn <span class="token operator">></span> <span class="token number">1</span>
<span class="token punctuation">)</span>
</code></pre></div>
<p>But what to do if there's no unique Id? Temporary table is an approach - first we create <code>feedback_temp</code> where only unique records from all set of duplicates will be stored.</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">CREATE</span> <span class="token keyword">TABLE</span> feedback_temp <span class="token keyword">as</span> <span class="token punctuation">(</span>
    <span class="token keyword">with</span> dups <span class="token keyword">as</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> feedback_id
        <span class="token keyword">from</span> feedback
        <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span>
        <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span>
    <span class="token punctuation">)</span>
    <span class="token punctuation">,</span> sorted <span class="token keyword">as</span> <span class="token punctuation">(</span>
        <span class="token keyword">select</span> row_number<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">over</span> <span class="token punctuation">(</span><span class="token keyword">partition</span> <span class="token keyword">by</span> ff<span class="token punctuation">.</span>feedback_id <span class="token keyword">order</span> <span class="token keyword">by</span> <span class="token keyword">date</span> <span class="token keyword">desc</span><span class="token punctuation">)</span> rn<span class="token punctuation">,</span> f<span class="token punctuation">.</span><span class="token operator">*</span>
        <span class="token keyword">from</span> feedback f
            <span class="token keyword">right</span> <span class="token keyword">join</span> dups d <span class="token keyword">on</span> d<span class="token punctuation">.</span>feedback_id <span class="token operator">=</span> f<span class="token punctuation">.</span>feedback_id
    <span class="token punctuation">)</span>
    <span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> sorted <span class="token keyword">where</span> rn <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Next step is to remove the duplicates from initial table</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">delete</span> <span class="token keyword">from</span> feedback
<span class="token keyword">where</span> feedback_id <span class="token operator">in</span> <span class="token punctuation">(</span>
    <span class="token keyword">select</span> feedback_id
    <span class="token keyword">from</span> feedback
    <span class="token keyword">group</span> <span class="token keyword">by</span> <span class="token number">1</span>
    <span class="token keyword">having</span> <span class="token function">count</span><span class="token punctuation">(</span><span class="token operator">*</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">1</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div>
<p>Then we just need to insert data back and remove temp table</p>
<div class="remark-highlight"><pre class="language-sql"><code class="language-sql"><span class="token keyword">BEGIN</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>

<span class="token keyword">insert</span> <span class="token keyword">into</span> feedback
<span class="token punctuation">(</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> feedback_temp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">drop</span> <span class="token keyword">table</span> feedback_temp<span class="token punctuation">;</span>

<span class="token keyword">END</span> <span class="token keyword">TRANSACTION</span><span class="token punctuation">;</span>
</code></pre></div>
</div></article><div><span class="utils_tag__r8GDN"><a href="/tag/aws">[<!-- -->aws<!-- -->]</a></span><span class="utils_tag__r8GDN"><a href="/tag/redshift">[<!-- -->redshift<!-- -->]</a></span><span class="utils_tag__r8GDN"><a href="/tag/sql">[<!-- -->sql<!-- -->]</a></span><span class="utils_tag__r8GDN"><a href="/tag/postgres">[<!-- -->postgres<!-- -->]</a></span><span class="utils_tag__r8GDN"><a href="/tag/duplicates">[<!-- -->duplicates<!-- -->]</a></span></div></main><div class="layout_backToHome__9sjx_"><a href="/">‚áê back to home</a></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"postData":{"id":"redshift-duplicates","contentHtml":"\u003cp\u003eSometimes you got duplicates in database and have to deal with it. There's 2 possibilities - you have an auto-generated unique id on the table or not. The first case is very easy\u003c/p\u003e\n\u003cp\u003eLet say we have table feedback where we collect all the feedbacks given by our users. This table has field \u003ccode\u003efeedback_id\u003c/code\u003e which represents unique id of external system from which data was posted.\u003c/p\u003e\n\u003ctable\u003e\n    \u003cthead\u003e\n        \u003ctr\u003e\n            \u003cth\u003eid\u003c/th\u003e\n            \u003cth\u003efeedback_id\u003c/th\u003e\n            \u003cth\u003etype\u003c/th\u003e\n            \u003cth\u003edate\u003c/th\u003e\n        \u003c/tr\u003e\n    \u003c/thead\u003e\n    \u003ctbody \u003e\n        \u003ctr\u003e\n            \u003ctd\u003e0001\u003c/td\u003e\n            \u003ctd\u003eMX-001\u003c/td\u003e\n            \u003ctd\u003elivechat\u003c/td\u003e\n            \u003ctd\u003e2020-01-01\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003ctd\u003e0002\u003c/td\u003e\n            \u003ctd\u003eMX-001\u003c/td\u003e\n            \u003ctd\u003elivechat\u003c/td\u003e\n            \u003ctd\u003e2020-01-01\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003ctd\u003e0003\u003c/td\u003e\n            \u003ctd\u003eMX-001\u003c/td\u003e\n            \u003ctd\u003elivechat\u003c/td\u003e\n            \u003ctd\u003e2020-01-01\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003ctd\u003e0004\u003c/td\u003e\n            \u003ctd\u003eMX-002\u003c/td\u003e\n            \u003ctd\u003ependo\u003c/td\u003e\n            \u003ctd\u003e2020-01-03\u003c/td\u003e\n        \u003c/tr\u003e\n        \u003ctr\u003e\n            \u003ctd\u003e0005\u003c/td\u003e\n            \u003ctd\u003eMX-002\u003c/td\u003e\n            \u003ctd\u003ependo\u003c/td\u003e\n            \u003ctd\u003e2020-01-03\u003c/td\u003e\n        \u003c/tr\u003e\n    \u003c/tbody\u003e\n\u003c/table\u003e\n\u003cp\u003eIf we created an auto-generated Id on it then we safe\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003edelete\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e id \u003cspan class=\"token operator\"\u003ein\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e dups \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e id\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e\n            row_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epartition\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e feedback_id \u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edesc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e rn\n        \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e id \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e dups \u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e rn \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eBut what to do if there's no unique Id? Temporary table is an approach - first we create \u003ccode\u003efeedback_temp\u003c/code\u003e where only unique records from all set of duplicates will be stored.\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTABLE\u003c/span\u003e feedback_temp \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ewith\u003c/span\u003e dups \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e feedback_id\n        \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback\n        \u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003ehaving\u003c/span\u003e \u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e sorted \u003cspan class=\"token keyword\"\u003eas\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e row_number\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eover\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003epartition\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e ff\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efeedback_id \u003cspan class=\"token keyword\"\u003eorder\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edate\u003c/span\u003e \u003cspan class=\"token keyword\"\u003edesc\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e rn\u003cspan class=\"token punctuation\"\u003e,\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\n        \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback f\n            \u003cspan class=\"token keyword\"\u003eright\u003c/span\u003e \u003cspan class=\"token keyword\"\u003ejoin\u003c/span\u003e dups d \u003cspan class=\"token keyword\"\u003eon\u003c/span\u003e d\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efeedback_id \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e f\u003cspan class=\"token punctuation\"\u003e.\u003c/span\u003efeedback_id\n    \u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e sorted \u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e rn \u003cspan class=\"token operator\"\u003e=\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eNext step is to remove the duplicates from initial table\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003edelete\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback\n\u003cspan class=\"token keyword\"\u003ewhere\u003c/span\u003e feedback_id \u003cspan class=\"token operator\"\u003ein\u003c/span\u003e \u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e feedback_id\n    \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback\n    \u003cspan class=\"token keyword\"\u003egroup\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eby\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n    \u003cspan class=\"token keyword\"\u003ehaving\u003c/span\u003e \u003cspan class=\"token function\"\u003ecount\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token operator\"\u003e*\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e \u003cspan class=\"token operator\"\u003e\u003e\u003c/span\u003e \u003cspan class=\"token number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n\u003cp\u003eThen we just need to insert data back and remove temp table\u003c/p\u003e\n\u003cdiv class=\"remark-highlight\"\u003e\u003cpre class=\"language-sql\"\u003e\u003ccode class=\"language-sql\"\u003e\u003cspan class=\"token keyword\"\u003eBEGIN\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTRANSACTION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003einsert\u003c/span\u003e \u003cspan class=\"token keyword\"\u003einto\u003c/span\u003e feedback\n\u003cspan class=\"token punctuation\"\u003e(\u003c/span\u003e\u003cspan class=\"token keyword\"\u003eselect\u003c/span\u003e \u003cspan class=\"token operator\"\u003e*\u003c/span\u003e \u003cspan class=\"token keyword\"\u003efrom\u003c/span\u003e feedback_temp\u003cspan class=\"token punctuation\"\u003e)\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003edrop\u003c/span\u003e \u003cspan class=\"token keyword\"\u003etable\u003c/span\u003e feedback_temp\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\n\u003cspan class=\"token keyword\"\u003eEND\u003c/span\u003e \u003cspan class=\"token keyword\"\u003eTRANSACTION\u003c/span\u003e\u003cspan class=\"token punctuation\"\u003e;\u003c/span\u003e\n\u003c/code\u003e\u003c/pre\u003e\u003c/div\u003e\n","title":"Remove Postgres / Redshift duplicates without unique key","date":"2021-03-03T07:37:23+01:00","status":"publish","permalink":"/?p=1069","author":"pavel","excerpt":"","type":"post","tag":["aws","redshift","sql","postgres","duplicates"]}},"__N_SSG":true},"page":"/posts/[id]","query":{"id":"redshift-duplicates"},"buildId":"yW2av1iPx4W7zVrpw7Efh","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>